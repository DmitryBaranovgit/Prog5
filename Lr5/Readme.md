# Лвбораторная работа 5. Рвбота с валютами. Шаблон «Одиночка»

## Описание задания
В данной лабораторной работе реализован шаблон проектирования "Одиночка" с использованием метаклассов, который позволяет поучать курсы валют с сайта Центрального Банка в объектно-ориентированном стиле. Реализован класс ```CurrencyManager```, который предоставляет доступ к информации о курсах валют, следуя правилам задания:

1. Шаблон "Одиночка" - класс ```CurrencyManager``` может иметь только один экземпляр.
2. Метод для получения валют - метод ```get_currencies``` запрашивает и возвращает курсы валют, используя кэширование для предотвращения частых запросов.
3. Форматирование значений валют - курс валюты хранится в формате с отдельными частями: целой и дробной.
4. Визуализация данных - реализован метод для отображения курсов валют в виде графика, который сохраняется в файл ```currencies.jpg```.

## Реализация
### SingletonMeta
Класс SingletonMeta реализует шаблон проектирования "Одиночка", ограничивая количество экземпляров класса ```CurrencyManager``` до одного.

```
class SingletonMeta(type):
    _instances = {}

    def __call__(cls, *args, **kwargs):
        if cls not in cls._instances:
            instance = super().__call__(*args, **kwargs)
            cls._instances[cls] = instance
        return cls._instances[cls]
```

## CurrencyManager
Класс ```CurrencyManager``` предоставляет методы для получения и визуализации курсов валют:

* Атрибуты:
* ```_last_request_time``` - время последнего запроса для контроля частоты обращения к API.
* ```_cache``` - кэш для хранения результатов последнего запроса.
* ```_currencies_data``` - хранение актульных данных о валюте.

* Методы:
* ```get_currencies(currencies_ids_lst, refresh_interval = 1)``` - возвращает курсы валют по заданным идентификаторам. В случае частого запроса возвращаются кэшированные данные.
* visualize_currencies() - строит график курсов валют и сохраняет его в ```currencies.jpg```.

```
class CurrencyManager(metaclass = SingletonMeta):
    def __init__(self):
        self._last_request_time = 0
        self._cache = {}
        self._currencies_data = None

    def get_currencies(self, currencies_ids_lst: list, refresh_interval: int = 1) -> list:
    # Логика для получения курсов валют...
    def visualize_currencies(self):
    # Логика для визуализации данных...

 ```
##  Тесты
Для проверки работоспособности классов и методов реализованы тесты:

* ```test_get_currencies_correct_ids()``` - проверка на корректность возврата данных по валидным идентификаторам.
* ```test_get_currencies_incorrect_id()``` - проверка обработки ошибки при неправильном идентификаторе.

```
def test_get_currencies_correct_ids():
  # Проверка корректного ID
def test_get_currencies_incorrect_id():
  # Проверка неправилного ID
```

# Пример использования
```
if __name__ == '__main__':

    currency_ids = ['R01035', 'R01335', 'R01700J']
    manager = CurrencyManager()
    result = manager.get_currencies(currency_ids)

    if result:
        print("Полученные данные о валютах:", result)
        manager.visualize_currencies()

    test_get_currencies_correct_ids()
    test_get_currencies_incorrect_id()
```
# Формат результата
Результат возвращается в следующем формате:
```
Полученные данные о валютах: [{'GBP': ('Фунт стерлингов Соединенного королевства', ('126', '4156'), 1)}, {'KZT': ('Казахстанских тенге', ('19', '9278'), 100)}, {'TRY': ('Турецких лир', ('28', '6638'), 10)}]
Тест на корректные ID пройден.
Тест на неправильный ID пройден.
Удаление объекта CurrencyManager
```
# Файлы
```main.py``` - основной код программы
```currencies.jpg``` - визуализация курсов валют в виде столбчатой диаграммы
```Readme.md``` - описание лабораторной работы
